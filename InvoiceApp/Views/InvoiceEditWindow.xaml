<Window x:Class="InvoiceApp.Views.InvoiceEditWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Invoice Details" Height="800" Width="1000"
        WindowStartupLocation="CenterScreen" WindowState="Maximized"
        Background="#F5F5F5">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="300"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header Section -->
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <TextBlock Text="Invoice Information" 
                          FontSize="18" 
                          FontWeight="Bold" 
                          Margin="0,0,0,15"/>

                <Label Content="Invoice Number:" FontWeight="Bold"/>
                <TextBox x:Name="InvoiceNumberTextBox" 
                        Height="30" 
                        IsReadOnly="True"
                        Background="#E0E0E0"/>

                <Label Content="Client: *" FontWeight="Bold" Margin="0,10,0,0"/>
                <ComboBox x:Name="ClientComboBox" 
                         Height="35"
                         DisplayMemberPath="CompanyName"
                         SelectedValuePath="Id"/>
            </StackPanel>

            <StackPanel Grid.Column="1" Margin="20,0,0,0">
                <Label Content="Invoice Date: *" FontWeight="Bold" Margin="0,34,0,0"/>
                <DatePicker x:Name="InvoiceDatePicker" 
                           Height="35"/>

                <Label Content="Due Date: *" FontWeight="Bold" Margin="0,10,0,0"/>
                <DatePicker x:Name="DueDatePicker" 
                           Height="35"/>
            </StackPanel>
        </Grid>

        <!-- Line Items Section with Fixed Height -->
        <Border Grid.Row="1" Margin="0,20,0,0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" 
                          Text="Line Items" 
                          FontSize="16" 
                          FontWeight="Bold" 
                          Margin="0,0,0,10"/>

                <DataGrid Grid.Row="1" 
                         x:Name="LineItemsDataGrid"
                         AutoGenerateColumns="False"
                         CanUserAddRows="False"
                         SelectionMode="Single"
                         HeadersVisibility="Column"
                         GridLinesVisibility="All"
                         AlternatingRowBackground="WhiteSmoke">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
                        <DataGridTextColumn Header="Quantity" Binding="{Binding Quantity}" Width="80"/>
                        <DataGridTextColumn Header="Unit Price" Binding="{Binding UnitPrice, StringFormat=N2}" Width="100"/>
                        <DataGridTextColumn Header="Tax %" Binding="{Binding TaxRate}" Width="70"/>
                        <DataGridTextColumn Header="Total" Binding="{Binding LineTotal, StringFormat=N2}" Width="100" IsReadOnly="True"/>
                    </DataGrid.Columns>
                </DataGrid>

                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                    <Button Content="Add Item" 
                           Width="100" 
                           Height="30"
                           Click="AddItemButton_Click"/>
                    <Button Content="Remove Item" 
                           Width="100" 
                           Height="30"
                           Margin="10,0,0,0"
                           Click="RemoveItemButton_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Totals and Notes Section -->
        <Grid Grid.Row="2" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <Label Content="Notes:" FontWeight="Bold"/>
                <TextBox x:Name="NotesTextBox" 
                        Height="60"
                        AcceptsReturn="True"
                        TextWrapping="Wrap"
                        VerticalScrollBarVisibility="Auto"/>

                <Label Content="Payment Terms:" FontWeight="Bold" Margin="0,10,0,0"/>
                <TextBox x:Name="PaymentTermsTextBox" 
                        Height="50"
                        AcceptsReturn="True"
                        TextWrapping="Wrap"
                        VerticalScrollBarVisibility="Auto"/>
            </StackPanel>

            <Border Grid.Column="1" Margin="20,0,0,0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Background="White">
                <StackPanel>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="120"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Subtotal:" FontSize="14" Margin="0,5"/>
                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="SubtotalTextBlock" Text="R0.00" FontSize="14" TextAlignment="Right" Margin="0,5"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Tax:" FontSize="14" Margin="0,5"/>
                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="TaxTextBlock" Text="R0.00" FontSize="14" TextAlignment="Right" Margin="0,5"/>

                        <Border Grid.Row="2" Grid.ColumnSpan="2" BorderBrush="Black" BorderThickness="0,1,0,0" Margin="0,5"/>
                    </Grid>

                    <Grid Margin="0,10,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="120"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Total:" FontSize="16" FontWeight="Bold"/>
                        <TextBlock Grid.Column="1" x:Name="TotalTextBlock" Text="R0.00" FontSize="16" FontWeight="Bold" TextAlignment="Right"/>
                    </Grid>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Buttons -->
        <!-- Buttons -->
        <StackPanel Grid.Row="3" 
           Orientation="Horizontal" 
           HorizontalAlignment="Right" 
           Margin="0,20,0,0">
            <Button Content="Export PDF" 
           Width="120" 
           Height="35"
           Background="#3498DB"
           Foreground="White"
           BorderThickness="0"
           Click="ExportPdfButton_Click"
           Margin="0,0,10,0"/>
            <Button Content="Send Email" 
           Width="120" 
           Height="35"
           Background="#9B59B6"
           Foreground="White"
           BorderThickness="0"
           Click="SendEmailButton_Click"
           Margin="0,0,10,0"/>
            <Button Content="Save" 
           Width="100" 
           Height="35"
           Background="#2ECC71"
           Foreground="White"
           BorderThickness="0"
           Click="SaveButton_Click" 
           IsDefault="True"
           Margin="0,0,10,0"/>
            <Button Content="Cancel" 
           Width="100" 
           Height="35"
           Background="#95A5A6"
           Foreground="White"
           BorderThickness="0"
           Click="CancelButton_Click" 
           IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>
<UserControl x:Class="InvoiceApp.Views.InvoiceListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:converters="clr-namespace:InvoiceApp.Converters">
    <UserControl.Resources>
        <converters:StatusToBrushConverter x:Key="StatusToBrushConverter"/>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Invoices" Style="{StaticResource TitleTextBlock}"/>

        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
            <Button Content="Create Invoice" Command="{Binding CreateInvoiceCommand}"/>
            <Button Content="Edit" Command="{Binding EditInvoiceCommand}"/>
            <Button Content="Delete" Command="{Binding DeleteInvoiceCommand}"/>
            <Button Content="Duplicate" Command="{Binding DuplicateInvoiceCommand}"/>
            <Button Content="Refresh" Command="{Binding RefreshCommand}"/>
            <Button Content="💰 Record Payment" 
                   Command="{Binding RecordPaymentCommand}"
                   Background="#2ECC71"
                   Foreground="White"
                   Margin="10,0,0,0"/>
            <TextBox Width="200" 
                    Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                    VerticalAlignment="Center" 
                    Margin="20,0,0,0"/>
            <TextBlock Text="Search" 
                      VerticalAlignment="Center" 
                      Margin="5,0"/>
        </StackPanel>

        <DataGrid Grid.Row="2" 
                 ItemsSource="{Binding Invoices}" 
                 SelectedItem="{Binding SelectedInvoice}"
                 AutoGenerateColumns="False"
                 IsReadOnly="True"
                 GridLinesVisibility="None"
                 HeadersVisibility="Column"
                 RowBackground="White"
                 AlternatingRowBackground="#F8F9FA"
                 BorderThickness="1"
                 BorderBrush="#E0E0E0"
                 CanUserResizeRows="False"
                 SelectionMode="Single">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Invoice #" Binding="{Binding InvoiceNumber}" Width="120"/>
                <DataGridTextColumn Header="Client" Binding="{Binding Client.CompanyName}" Width="*"/>
                <DataGridTextColumn Header="Date" Binding="{Binding InvoiceDate, StringFormat=d}" Width="100"/>
                <DataGridTextColumn Header="Due Date" Binding="{Binding DueDate, StringFormat=d}" Width="100"/>
                <DataGridTextColumn Header="Total" Binding="{Binding Total, StringFormat=C}" Width="100"/>
                <DataGridTextColumn Header="Paid" Binding="{Binding AmountPaid, StringFormat=C}" Width="100"/>
                <DataGridTextColumn Header="Remaining" Binding="{Binding AmountRemaining, StringFormat=C}" Width="100"/>

                <!-- Colored Status Badge -->
                <DataGridTemplateColumn Header="Status" Width="120">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Border Background="{Binding Status, Converter={StaticResource StatusToBrushConverter}}" 
                                   CornerRadius="12" 
                                   Padding="8,4"
                                   HorizontalAlignment="Center">
                                <TextBlock Text="{Binding Status}" 
                                          Foreground="White" 
                                          FontSize="11"
                                          FontWeight="SemiBold"
                                          TextAlignment="Center"/>
                            </Border>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</UserControl>